-- Servi√ßos essenciais
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Player = Players.LocalPlayer

-- Configura√ß√£o da UI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AutoParryUI"
screenGui.Parent = Player:WaitForChild("PlayerGui")

local statusFrame = Instance.new("Frame")
statusFrame.Size = UDim2.new(0.2, 0, 0.05, 0)
statusFrame.Position = UDim2.new(0.05, 0, 0.9, 0)
statusFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
statusFrame.BackgroundTransparency = 0.5
statusFrame.BorderSizePixel = 0
statusFrame.Parent = screenGui

local statusLabel = Instance.new("TextLabel")
statusLabel.Text = "üü¢ AUTOPARRY PRONTO"
statusLabel.Size = UDim2.new(1, 0, 1, 0)
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.BackgroundTransparency = 1
statusLabel.Font = Enum.Font.GothamBold
statusLabel.TextSize = 12
statusLabel.Parent = statusFrame

-- Vari√°veis de estado
local lastBallPosition = nil
local lastUpdate = 0
local fps = 0

-- Fun√ß√£o para verificar se √© SEU personagem
local function IsMyCharacter(model)
    if not model then return false end
    if model:IsA("Model") and model:FindFirstChild("Humanoid") then
        return model:GetAttribute("Player") == Player or model.Name == Player.Name
    end
    return false
end

-- Atualiza√ß√£o do FPS
local function UpdateFPS()
    fps = math.floor(1/RunService.Heartbeat:Wait())
    statusLabel.Text = string.format("üü¢ AUTOPARRY PRONTO | FPS: %d", fps)
end

task.spawn(function()
    while true do
        UpdateFPS()
        wait(1)
    end
end)

-- Sistema principal de parry
RunService.Heartbeat:Connect(function()
    -- Otimiza√ß√£o: processa apenas a cada 0.1s
    local now = tick()
    if now - lastUpdate < 0.1 then return end
    lastUpdate = now

    -- Encontra a bola
    local ball = workspace:FindFirstChild("Part") -- Nome da bola no jogo
    if not ball or not ball:IsA("BasePart") then return end
    
    -- Verifica SEU personagem
    local myCharacter = Player.Character
    if not IsMyCharacter(myCharacter) then return end
    
    local myHRP = myCharacter:FindFirstChild("HumanoidRootPart")
    if not myHRP then return end
    
    -- C√°lculo de velocidade precisa
    local currentBallPos = ball.Position
    local ballVelocity = if lastBallPosition 
        then (currentBallPos - lastBallPosition) * 20 
        else Vector3.new(0, 0, 0)
    lastBallPosition = currentBallPos
    
    -- Verifica√ß√£o de dist√¢ncia e dire√ß√£o
    local distance = (myHRP.Position - currentBallPos).Magnitude
    local directionToMe = (myHRP.Position - currentBallPos).Unit
    local isApproaching = (ballVelocity.Unit:Dot(directionToMe) > 0.8) -- 80% de certeza
    
    -- Ativa o parry apenas quando a bola est√° vindo para VOC√ä
    if distance < 8 and isApproaching then
        mouse1click()
        statusLabel.Text = string.format("‚ö° PARRY ATIVADO | FPS: %d", fps)
        task.delay(0.1, function()
            statusLabel.Text = string.format("üü¢ AUTOPARRY PRONTO | FPS: %d", fps)
        end)
    end
end)

-- Toggle com F10
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.F10 then
        screenGui.Enabled = not screenGui.Enabled
    end
end)

print("AutoParry carregado com sucesso!")
